---
layout: post
title: cpu高了
categories: performance
tags: cpu performance
---

#### 案例一:死循环 {#die_loop}

##### 测试代码

    public class HeapOom {
        static class OOMObject {
        }
        public static void main(String[] args) {
            List<OOMObject> list = new ArrayList<OOMObject>();
            while (true) {
                list.add(new OOMObject());
            }
        }
    }

#### 检测
1.top拿到cpu密集的java进程 24744，shift + H拿到cpu密集的线程 24745 `top -Hp 24744`

![top](/images/performance/top.png)

2.`jstack -F 24744 > stack.log`

3.检测对应代码 printf "%x\n" 24745 找到nid为24745对应的线程。

![cpu](/images/performance/cpu.png)

4.卧槽，死循环了。（当然这个还内存溢出）


#### 案例二：行程单系统不fullGC


#### 参考

[1]<http://lovestblog.cn/blog/2016/03/31/cpu-thread/>

